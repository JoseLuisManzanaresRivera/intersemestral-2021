---
title: "Unidad 2 Tema 2.3"
author: "José Luis Manzanares Rivera"
date: '2022-11-01T21:13:15-05:00'
---

```{r, message=FALSE,warning=FALSE,include=FALSE}
library(tidyverse)
library(datagovindia)
library(plotly)
library(gapminder)
```


## Distribuciones de probabilidad 


#### Objetivos


Estudiar la importancia de las distribuciones de probabilidad en contexto de variables aleatorias y aplicar estos conocimientos a la estimación de probabilidades en el caso discreto y continuo. 

##### Metas de aprendizaje particulares



+ Diferenciar entre ditribuciones discretas y continuas.

+ Estudiar la distribución de probabiliad **Binomial**.  Presentando la definición del coeficieonte binomial, así como el algoritmo de estimación para asignar probabilidades en el caso de una situación binamial.

+ Realizar estimaciones de probabilidad para situaciónes en el contexto binomial.


---------------

## Introducción.

##### Distinción entre variables aleatorias discretas y contínuas.


Iniciaremos esta sesión con el estudio de la  Distribución de probabilidad para **variables aleatorias discretas.**
 
Es **importante** recordar de la sesión previa la defición de **variable aleatoria**, misma que se incluye a continuación para mayor referencia. 

**Variable  aleatoria:**  subconjunto del epacio muestral **M** que se integra por los resultados de eventos cuyo resultado es **incierto**. 


Una variable aleatoria **es discreta** si toma un número finito de valores. 
Entonces nos referiremos a una **variable discreta** como aquella que adopta valores en $X \in \mathbb{N}$


Las variables discretas pueden resultar, tanto de **situaciones puramente cuantitativas**  como también **cualitativas**, en cuyo caso bastará con asignar un número a cada resultado para identificar cada evento.  

**Ejemplo de una variable aleatoria discreta**

El valor que adopta el resultado del lanzamiento de un dado de **seis caras**. 

Este es un experimento que puede adoptar los valores contenidos en el siguiente **conjunto discreto** X={1,2,3,4,5,6}.


**Ejemplo de una variable aleatoria discreta cualitativa**

El nivel de desarrollo de un país puede identificarse como: Altamente desarrollado o bien en desarrollo. En este caso la variable nivel del desarrollo, puede adoptar dos valores que podemos identificar como {Altamente desarrollado, en desarrollo} o bien usando una notación númerica: {0,1}. 

##### Variables aleatorias continuas.

Una variable aleatoria es continua si toma valores en un intervalo de la recta real; es decir, si su recorrido es **infinito no numerable.**

Esta clasificación se necesita, porque si tratamos de asociar a cada **valor** de la **variable aleatoria** una probabilidad de que ocurra, entonces:

+ Si la **variable aleatoria es discreta**, siempre es posible asociar a cada uno de sus valores, la probabilidad de que se produzca este valor, de forma que esta probabilidad cumplan lo siguiente:


1.- No siempre es nula. $$P(A)\geq0$$ 

2.- La suma de las probabilidades asociadas a cada uno de los valores de las variables en el espacio muestral es **uno**.
$$P(M)=1$$

3.- La probabilidad de que ocurra uno, otro o ambos eventos, está dada por la suma de sus probabilidades individuales.

$$P(A_{1}\cup A_{2}\cup...)=P(A_{1})+P(A_{2})...$$  


4. Y por el teorema 1-5, cuando **A** se integra por todos los elementos del espacio muestral **M**, la suma de la probabilidad de todos los eventos individuales de **A** es 1.  $$A=M\Rightarrow P(A)=P(A_{1})+P(A_{2})+...+P(A_{n})=1$$


+ Si la variable **aleatoria es continua**, no podemos asociar a cada valor que pueda tomar esta variable, la probabilidad de que éste ocurra, de forma que esta probabilidad cumpla las dos condiciones anteriores. 


Esto es debido a que si en un intervalo de la recta real, tratamos de hallar la probabilidad de un número de este intervalo con un valor concreto **a**, observaremos que,  esta probabilidad es el número de casos favorables, que es 1 (el punto a), dividido entre el número de casos posibles **(infinito)** y por tanto, tendremos que
concluir que esta es **cero**.ej $$P(a)=0$$  por que: 

$$\frac{1}{\infty}=0$$ 

de lo que se deduciría que éste es un **suceso imposible**; Acorde con el teorema 1-3, visto en la clase anterior $$P(\varnothing)=0$$
sin embargo, que la variable aleatoria tome el valor **a** no es un suceso imposible. No es un $\varnothing$






 
 




![](/img/reglas1_Prob.jpg)

En particular note que la **regla 4** refiere la probabilidad de dos eventos que **no pueden ocurrir juntos**, estos eventos se denominan **disjuntos**

**Definición**  Son eventos disjuntos aquellos que no pueden ocurrir al mismo tiempo.

Los eventos **A** y **B** son disjuntos si su intersección es cero. 
$A\cap B=0$





#### Distribución Binomial.

¿A qué nos referimos con una disrtibución Binomial? 

¿Qué circunstancias dan lugar a una distribución binomial? 



1. Tenemos un determinado número **n** de observaciones.

2. Las **n** observaciones son todas **independientes**. 

Es decir, saber el resultado de una observación **no te indica nada sobre las restantes observaciones**.

3. Cada observación tiene **dos** resultados posibles, que por conveniencia llamaremos **“éxito”** y **“fracaso”.**

4. La probabilidad de éxito, llámada **p**, es **igual** en todas las observaciones.


**Ejemplo: 1** 

Lanzar una moneda **n** veces es un ejemplo de **situación binomial**. 

Cada lanzamiento puede dar águila  o sol.

Conocer el resultado de un lanzamiento no nos dice nada sobre el resultado de los otros lanzamientos, por tanto, los **n** lanzamientos
son **independientes.** 

Si llamamos **“éxito”** a los sol, la probabilidad **p** de obtener
**sol** se mantiene constante si no cambiamos de moneda. 

El recuento del número
de **soles** es una **variable aleatoria X**. La distribución de **X** se llama **distribución
binomial.**


##### Definición: 

La distribución del recuento **X** de **éxitos** en una **situación binomial** es la
distribución binomial con parámetros **n** y **p**. 

Donde el parámetro **n** denota el número
de observaciones. 

Donde el parametro **p** indica la probabilidad de éxito de cualquier observación.

Y los valores de **X**  estan definidos por **números enteros positivos** en el intetvalo [**0 a n)**.


Es muy importante que los eventos sean **INDEPENDIENTES** para que una situación pueda definirse como binomial, no solo debemos verificar que se tengan **dos posibles** resultados.


**Ejemplo 2**

Observe que la siguiente situación **no cumple** con **el criterio** de independencia y por lo tanto no puede considerarse **situación binomial**.


Selecciona 10 cartas de una baraja de póquer y cuenta el número X de cartas rojas. 


Note que una baraja tiene dos cartas de **dos colores: Rojo y Negro.**

Tenemos 10 observaciones y cada una de ellas puede ser una carta roja o una carta negra. 

Definimos Un **“éxito”** como una carta **roja.** Note que tenomos dos posibles resultados, pero se viola el criterio de independencia, las observaciones **no son independientes.**

Ya que,  si **la primera carta es negra**, la segunda carta tiene más probabilidades de ser roja, ya que quedan más cartas rojas que negras en la baraja.


**Ejemplo 3**

Observas el sexo de los próximos 20 bebés nacidos en un hospital; **X** es el número de niñas.

+ Tenemos dos posibles resultados:  OK
+ Tenemos definida el evento éxito: OK
+ Los eventos son independientes:   OK


En este caso tenemos una situación binimial.

Para calcular la **probabilidad** de que una variable
aleatoria binomial tome un valor determinado es necsario: 

Determinar el número de maneras de combinar  **k** éxitos de entre **n** observaciones. Este número de combinaciones posibles se expresa por el  denominado **coeficiente binomial** que cuya notación se presenta a continuación.


##### COEFICIENTE BINOMIAL

El número de maneras de combinar **k** éxitos entre **n** observaciones viene dado por el **coeficiente binomial**


$$\binom{n}{k} = \frac{n!}{k!(n-k)!}$$

para  $k=0,1,2,...,n$

**Note** que  estamos usando la notación factorial. 

Recuerde que para estimar el **factorial** de cualquier número entero positivo **n**, es necesario estimar el producto de los elmentos secuencalente inferiores:

n! = n × (n − 1) × (n − 2) ×···× 3 × 2 × 1


**Por ejemoplo**

+ 4! = 4x3x2x1=24.

+ 3! =3x2x1=6

+ 6!= 6x5x4x3x2x1=720

O simplemente usando la función     `factorial en R` 
+ Por definción el caso particular de  0!=1.


##### PROBABILIDAD BINOMIAL


Si **X** tiene una **distribución binomial** con **n** observaciones y con una probabilidad **p** de éxito en cada observación k  = 0, 1, 2, . . . , n.  de **x**, Entonces.  


$$P(X=k)=\binom{n}{k}p^{k}(1-p)^{n-k}$$

**IMPORTANTE:** Cuando la situación binomial particular requiere la determinación de un intervalo, es necesario aplicar la regla de la suma. 

**Ejemplo** Si en una situación binomial (con dos resultados independientes) se sabe que la probabilidad de ocurrencia del evento denominado éxito es **p=0.25** ¿Cuál será la probabilidad binomial de  obtener **como máximo 2 éxitos entre 5 posibles elementos**.

Considerando la notación  vista hasta el momento en este caso  $k\leq2$ , n=5.




En primera instancia podemos estimar el coeficiente binomial para el número de exitos hasta k=2. Acorde con la situación descrita en la pregunta en donde buscamos la probabilidad de ocurrencia **"como máximo de dos exitos"**.


$$\binom{5}{2}=10$$

$$\binom{n}{k} = \frac{n!}{k!(n-k)!}$$

$$\binom{5}{2} = \frac{5!}{2!(5-2)!}$$
$$\binom{5}{2} =\frac{5!}{2!(3)!}=\frac{120}{12}=10$$
$$\binom{5}{1}=5$$
$$\binom{5}{0}=1$$

**Note que por definición:**  

$$\binom{5}{0} = \frac{n!}{k!(n-k)!}=\frac{120}{1(5)}!=\frac{120}{120}=1$$

##### Uso de Software.

**Uso del software en la determinación de los coeficientes binomiales**

```{r, warning=FALSE, message=FALSE}

## Usamos la función  `VeryLargeIntegers` para estimar el coeficiente binomial.

library(VeryLargeIntegers)

binom(5, 2)
binom(5, 1)

### El coef binomial para n,k : 5,0=1 se sigue de la definición del coeficiente binomial.
```


Asi la probabilidad que buscamos queda definida por: 

$$P(X\leq2)=\binom{5}{2}p^{2}(1-p)^{5-2}+\binom{5}{1}p^{1}(1-p)^{5-1}+\binom{5}{0}p^{0}(1-p)^{5-0}$$


$$P(X\leq2)=\binom{5}{2}0.25^{2}(0.75)^{5-2}+\binom{5}{1}0.25^{1}(0.75)^{5-1}+\binom{5}{0}0.25^{0}(0.75)^{5-0}$$
Entonces, 

$$P(X\leq2)=10(0.25)^{2}(0.75)^{5-2}+5(0.25)^{1}(0.75)^{5-1}+1(0.25)^{0}(0.75)^{5-0}$$
$$P(X\leq2)=10(0.25)^{2}(0.75)^{3}+5(0.25)^{1}(0.75)^{4}+1(0.25)^{0}(0.75)^{5}$$



La probabilidad binomial de obtener "como máximo 2 éxitos" entre los 5 posibles elementos será $89.64\%$



###### Si usamos software.

Utilizaremos la funciión  `dbinom`  cuyos parámetros son: **(n,k,p)**

Recuerde que es importante observar la proposición que describe la probabilidad. Por ejemplo en el caso anterior se busca "como máximo 2 exitos" así que $k\leq2$  por lo tanto la probabilidad que buscamos es $p(X\leq{2})=P(X=2)+P(X=1)+P(X=0)$ 

**Note** en este caso **la suma de las probabilidades** concretas de cada combinación.


```{r}

##  dbinom(n,k,p) 

 dbinom(2,5,0.25) + dbinom(1,5,0.25) + dbinom(0,5,0.25) 

```










---------------------






 **Ejercicios**
 
 Repaso tema Distribución normal. 

![](/img/mediaymediana2.jpg)
![](/img/mediaymediana.jpg)

![](/img/ejerciciodensidad.jpg)






La **distribución de Bernoulli**

Es una distribución dicotómica. 

Si {\displaystyle X}X es una variable aleatoria discreta que mide el "número de éxitos" y se realiza un único experimento con dos posibles resultados denominados éxito y fracaso, se dice que la variable aleatoria **X** se distribuye como una **Bernoulli** de parámetro **p**  con  $$0<p<1$$ y escribimos   $X\sim \operatorname {Bernoulli} (p)$.

Si  (exito=1 , fracaso =0) , Exito toma la prob. p y fracaso q=(1-p)


![](/img/bernoulli.jpg)


Esta distribución presenta **dos estados.**  Como ejemplo más simple, el lanzamiento de una moneda.
Ver ejemplo **Sesión 3.ipynb**

Otros ejemplos empíricos con situaciones en donde se presenta una distribución **Binomial**, incluyen todas aquellas situaciones con dos resultados posibles: Ej. Pasar o no el exámen, lanzar una moneda, que un candidato a la presidencia gane o pierda, etc., 


-------------------------

 






